
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Example Usage &#8212; Machine Common Sense  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Python API" href="api.html" />
    <link rel="prev" title="Installation and Setup" href="install.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api.html" title="Python API"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation and Setup"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Machine Common Sense  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Example Usage</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="example-usage">
<h1>Example Usage<a class="headerlink" href="#example-usage" title="Permalink to this heading">¶</a></h1>
<p>Here are some example usage snippets for different use cases. Note that there are also additional scripts that may be useful in the machine_common_sense/scripts/ folder of the github project.</p>
<section id="using-your-own-config-data-and-or-unity-build">
<h2>Using your own config data and/or unity build<a class="headerlink" href="#using-your-own-config-data-and-or-unity-build" title="Permalink to this heading">¶</a></h2>
<p>For the below example, make sure <cite>MCS_CONFIG_FILE_PATH</cite> is not set, since it will override the <cite>config_file_or_dict</cite> specified below and is meant more for internal use by TA2 during evaluation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine_common_sense</span> <span class="k">as</span> <span class="nn">mcs</span>

<span class="c1"># Specify a location for the Unity app as opposed to downloading it automatically</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">create_controller</span><span class="p">(</span><span class="n">unity_app_file_path</span><span class="o">=</span><span class="s1">&#39;./some-path/unity-app&#39;</span><span class="p">,</span>
                                   <span class="n">config_file_or_dict</span><span class="o">=</span><span class="s1">&#39;./some-path/config.ini&#39;</span><span class="p">)</span>

<span class="c1"># Either load the scene data dict from an MCS scene config JSON file or create your own.</span>
<span class="c1"># We will give you the training scene config JSON files and the format to make your own.</span>
<span class="n">scene_data</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">load_scene_json_file</span><span class="p">(</span><span class="n">scene_json_file_path</span><span class="p">)</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">start_scene</span><span class="p">(</span><span class="n">scene_data</span><span class="p">)</span>

<span class="c1"># Use your machine learning algorithm to select your next action based on the scene</span>
<span class="c1"># output (goal, actions, images, metadata, etc.) from your previous action.</span>
<span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># Continue to select actions until your algorithm decides to stop.</span>
<span class="k">while</span> <span class="n">action</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="c1"># For interaction-based goals, your series of selected actions will be scored.</span>
<span class="c1"># For observation-based goals, you will pass a classification and a confidence</span>
<span class="c1"># to the end_scene function here.</span>
<span class="n">controller</span><span class="o">.</span><span class="n">end_scene</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that you can alternatively pass in a dictionary of config values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">controller</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">create_controller</span><span class="p">(</span><span class="n">unity_app_file_path</span><span class="o">=</span><span class="s1">&#39;./some-path/unity-app&#39;</span><span class="p">,</span>
                                   <span class="n">config_file_or_dict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;metadata&#39;</span><span class="p">:</span> <span class="s1">&#39;oracle&#39;</span><span class="p">,</span> <span class="s1">&#39;history_enabled&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="run-multiple-scenes-sequentially">
<h2>Run multiple scenes sequentially<a class="headerlink" href="#run-multiple-scenes-sequentially" title="Permalink to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine_common_sense</span> <span class="k">as</span> <span class="nn">mcs</span>

<span class="c1"># Only create the MCS controller ONCE!</span>
<span class="n">controller</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">create_controller</span><span class="p">(</span><span class="n">config_file_or_dict</span><span class="o">=</span><span class="p">{})</span>

<span class="k">for</span> <span class="n">scene_json_file_path</span> <span class="ow">in</span> <span class="n">scene_json_file_list</span><span class="p">:</span>
    <span class="n">scene_data</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">load_scene_json_file</span><span class="p">(</span><span class="n">scene_json_file_path</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">start_scene</span><span class="p">(</span><span class="n">scene_data</span><span class="p">)</span>
    <span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">action</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">controller</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
        <span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">end_scene</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="run-with-console-logging">
<h2>Run with console logging<a class="headerlink" href="#run-with-console-logging" title="Permalink to this heading">¶</a></h2>
<p><em>Note that logging is only available in versions 0.4.4 and above.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">machine_common_sense</span> <span class="k">as</span> <span class="nn">mcs</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;machine_common_sense&#39;</span><span class="p">)</span>
<span class="n">mcs</span><span class="o">.</span><span class="n">init_logging</span><span class="p">()</span>

<span class="n">controller</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">create_controller</span><span class="p">(</span><span class="n">config_file_or_dict</span><span class="o">=</span><span class="s1">&#39;./some-path/config.ini&#39;</span><span class="p">)</span>
<span class="n">scene_data</span> <span class="o">=</span> <span class="n">mcs</span><span class="o">.</span><span class="n">load_scene_json_file</span><span class="p">(</span><span class="n">scene_json_file_path</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">controller</span><span class="o">.</span><span class="n">start_scene</span><span class="p">(</span><span class="n">scene_data</span><span class="p">)</span>

<span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="k">while</span> <span class="n">action</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Taking </span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2"> with </span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">controller</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
    <span class="n">action</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">select_action</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

<span class="n">controller</span><span class="o">.</span><span class="n">end_scene</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="initialize-logging">
<h2>Initialize logging<a class="headerlink" href="#initialize-logging" title="Permalink to this heading">¶</a></h2>
<p><em>Note that logging is only available in versions 0.4.4 and above.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">machine_common_sense</span> <span class="k">as</span> <span class="nn">mcs</span>
<span class="kn">from</span> <span class="nn">machine_common_sense.logging_config</span> <span class="kn">import</span> <span class="n">LoggingConfig</span>

<span class="c1"># The following are 3 built in methods to initialize logging.  Only one of these should</span>
<span class="c1"># be called in a single execution as the last one will override any before it.</span>

<span class="c1"># Below initializes default which logs to console</span>
<span class="n">mcs</span><span class="o">.</span><span class="n">init_logging</span><span class="p">()</span>

<span class="c1"># Below initializes development default with file logging as well as console logging</span>
<span class="n">mcs</span><span class="o">.</span><span class="n">init_logging</span><span class="p">(</span><span class="n">LoggingConfig</span><span class="o">.</span><span class="n">get_dev_logging_config</span><span class="p">())</span>

<span class="c1"># Below initializes</span>
<span class="n">mcs</span><span class="o">.</span><span class="n">init_logging</span><span class="p">(</span><span class="n">LoggingConfig</span><span class="o">.</span><span class="n">get_errors_only_console_config</span><span class="p">())</span>
</pre></div>
</div>
</section>
<section id="run-with-human-input">
<h2>Run with Human Input<a class="headerlink" href="#run-with-human-input" title="Permalink to this heading">¶</a></h2>
<p>To start the Unity application and enter your actions and parameters from the terminal, you can run the <cite>run_in_human_input_mode</cite> script that was installed in the package with the MCS Python Library:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">run_in_human_input_mode &lt;mcs_scene_json_file&gt; --config_file_path &lt;mcs_config_ini_file&gt;</span>
</pre></div>
</div>
<p>If you don’t pass the <cite>–mcs_unity_build_file</cite> argument, the script will automatically download and run the Unity executable from our latest release.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">run_in_human_input_mode &lt;mcs_scene_json_file&gt; --config_file_path &lt;mcs_config_ini_file&gt; --mcs_unity_build_file &lt;mcs_unity_build_file&gt;</span>
</pre></div>
</div>
<p>If you clone the MCS GitHub repository, you can also run this script directly from our source code:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">python machine_common_sense/scripts/run_human_input.py &lt;mcs_scene_json_file&gt; --config_file_path &lt;mcs_config_ini_file&gt;</span>
</pre></div>
</div>
<p>MCS configuration files you can use:</p>
<ul class="simple">
<li><p>Oracle metadata: <cite>machine_common_sense/scripts/config_oracle.ini</cite></p></li>
<li><p>Oracle metadata, with debug data: <cite>machine_common_sense/scripts/config_oracle_debug.ini</cite></p></li>
<li><p>Level 2 metadata: <cite>machine_common_sense/scripts/config_level2.ini</cite></p></li>
<li><p>Level 2 metadata, with debug data: <cite>machine_common_sense/scripts/config_level2_debug.ini</cite></p></li>
<li><p>Level 1 metadata: <cite>machine_common_sense/scripts/config_level1.ini</cite></p></li>
<li><p>Level 1 metadata, with debug data: <cite>machine_common_sense/scripts/config_level1_debug.ini</cite></p></li>
<li><p>Default metadata: <cite>machine_common_sense/scripts/config_no_debug.ini</cite></p></li>
<li><p>Default metadata, with debug data: <cite>machine_common_sense/scripts/config_with_debug.ini</cite></p></li>
</ul>
<p><strong>Please note</strong>: The image you see in the Unity application will always be behind by one action step. The first image you see will be of the default white room that’s present before your specific scene is initialized. This is a <a class="reference external" href="https://github.com/allenai/ai2thor/issues/538">known issue</a> in our underlying AI2-THOR architecture.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Example Usage</a><ul>
<li><a class="reference internal" href="#using-your-own-config-data-and-or-unity-build">Using your own config data and/or unity build</a></li>
<li><a class="reference internal" href="#run-multiple-scenes-sequentially">Run multiple scenes sequentially</a></li>
<li><a class="reference internal" href="#run-with-console-logging">Run with console logging</a></li>
<li><a class="reference internal" href="#initialize-logging">Initialize logging</a></li>
<li><a class="reference internal" href="#run-with-human-input">Run with Human Input</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="install.html"
                          title="previous chapter">Installation and Setup</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="api.html"
                          title="next chapter">Python API</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/examples.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api.html" title="Python API"
             >next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation and Setup"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Machine Common Sense  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Example Usage</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, CACI.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 6.1.3.
    </div>
  </body>
</html>